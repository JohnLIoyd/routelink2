<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RouteLink - User Dashboard</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <nav class="navbar modern-navbar">
        <div class="nav-content">
            <div class="nav-brand">
                <h2>RouteLink</h2>
            </div>
            <div class="nav-menu">
                <a href="#" class="nav-link-item" onclick="showHome(); return false;">Home</a>
                <a href="#" class="nav-link-item" onclick="showAvailableTrucks(); return false;">Available Trucks</a>
                <a href="#" class="nav-link-item" onclick="showMessages(); return false;">
                    <svg width="18" height="18" viewBox="0 0 20 20" fill="currentColor" style="margin-right: 6px; vertical-align: middle;">
                        <path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"/>
                    </svg>
                    Messages
                </a>
                <div class="nav-item dropdown">
                    <button class="dropdown-btn" onclick="toggleDropdown(event)">
                        <span id="userName"></span>
                        <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
                            <path d="M6 9L1 4h10z"/>
                        </svg>
                    </button>
                    <div class="dropdown-menu">
                        <a href="#" onclick="closeDropdown(); showProfile(); return false;">Profile</a>
                        <a href="#" onclick="closeDropdown(); showSettings(); return false;">Settings</a>
                        <a href="#" onclick="closeDropdown(); showMessages(); return false;">Messages</a>
                        <a href="#" onclick="closeDropdown(); logout(); return false;">Logout</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>
    <div class="container">
        <div class="dashboard">
            <!-- Truck Availability Section -->
            <div class="trucks-section">
                <h1>Available Trucks</h1>
                <div class="trucks-grid" id="trucksGrid">
                    <!-- Trucks will be loaded here -->
                </div>
            </div>

            <!-- Track Driver Section -->
            <div class="track-driver-section">
                <div class="section-header">
                    <h1>Track Driver</h1>
                </div>
                <div class="track-driver-search">
                    <input type="text" id="trackDriverSearchInput" onkeyup="filterTrackDriver()" placeholder="Search driver or order...">
                </div>
                <div id="trackDriverMap" style="height: 400px; width: 100%; border-radius: 12px; background: #f0f0f0; display: flex; align-items: center; justify-content: center; margin-top: 16px;">
                    <div style="text-align: center; color: #718096;">
                        <p style="font-size: 18px; margin-bottom: 8px;">üìç Driver Tracking</p>
                        <p style="font-size: 14px;">Track your assigned driver's location here</p>
                    </div>
                </div>
            </div>

            <!-- Orders Section -->
            <div class="orders-section">
                <div class="orders-header">
                    <h1>My Orders</h1>
                    <button onclick="showNewOrderForm()" class="btn btn-primary btn-new-order">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M8 3a.5.5 0 0 1 .5.5v4h4a.5.5 0 0 1 0 1h-4v4a.5.5 0 0 1-1 0v-4h-4a.5.5 0 0 1 0-1h4v-4A.5.5 0 0 1 8 3z"/>
                        </svg>
                        New Order
                    </button>
                </div>
                <div class="orders-search">
                    <input type="text" id="ordersSearchInput" onkeyup="filterOrdersSearch()" placeholder="Search orders...">
                </div>
                
                <div class="orders-tabs">
                    <button class="tab-btn active" onclick="filterOrders('all')">All</button>
                    <button class="tab-btn" onclick="filterOrders('approval')">Approval</button>
                    <button class="tab-btn" onclick="filterOrders('completed')">Completed</button>
                    <button class="tab-btn" onclick="filterOrders('cancelled')">Cancelled</button>
                    <button class="tab-btn" onclick="filterOrders('draft')">Draft</button>
                </div>

                <div id="userBookings" class="orders-list">
                </div>
            </div>

            <!-- New Order Form -->
            <div class="section" id="newOrderSection" style="display: none;">
                <div class="booking-form-card modern-card">
                    <div class="card-header">
                        <h2>Create New Order</h2>
                        <button onclick="hideNewOrderForm()" class="close-btn">√ó</button>
                    </div>
                    <form id="bookingForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="pickupLocation">Pickup Location</label>
                            <input type="text" id="pickupLocation" required placeholder="Enter pickup address">
                        </div>
                        <div class="form-group">
                            <label for="destination">Destination</label>
                            <input type="text" id="destination" required placeholder="Enter destination address">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="pickupDate">Pickup Date</label>
                            <input type="date" id="pickupDate" required>
                        </div>
                        <div class="form-group">
                            <label for="pickupTime">Pickup Time</label>
                            <input type="time" id="pickupTime" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="cargoType">Cargo Type</label>
                        <select id="cargoType" required>
                            <option value="">Select cargo type</option>
                            <option value="general">General Freight</option>
                            <option value="fragile">Fragile Items</option>
                            <option value="heavy">Heavy Machinery</option>
                            <option value="perishable">Perishable Goods</option>
                            <option value="hazardous">Hazardous Materials</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="cargoWeight">Cargo Weight (kg)</label>
                        <input type="number" id="cargoWeight" required min="1" placeholder="Enter weight in kg">
                    </div>
                    <div class="form-group">
                        <label for="notes">Additional Notes</label>
                        <textarea id="notes" rows="3" placeholder="Any special instructions..."></textarea>
                    </div>
                        <button type="submit" class="btn btn-primary">Create Order</button>
                    </form>
                </div>
            </div>

            <!-- Profile Section -->
            <div class="section" id="profileSection" style="display: none;">
                <h2>My Profile</h2>
                <div class="profile-card">
                    <div class="profile-header">
                        <div class="profile-avatar" id="profileAvatar">
                            <img id="profileImage" style="display: none;" alt="Profile">
                            <span id="profileInitials"></span>
                        </div>
                        <h3 id="profileName"></h3>
                        <p id="profileRole"></p>
                    </div>
                    <form id="profileForm">
                        <div class="form-group">
                            <label for="profileImageInput">Profile Picture</label>
                            <input type="file" id="profileImageInput" accept="image/*" onchange="handleImageUpload(event)">
                            <small style="color: #666; display: block; margin-top: 5px;">Upload a profile picture (JPG, PNG, etc.)</small>
                            <div id="imagePreview" style="margin-top: 10px;"></div>
                        </div>
                        <div class="form-group">
                            <label for="profileNameInput">Full Name</label>
                            <input type="text" id="profileNameInput" required>
                        </div>
                        <div class="form-group">
                            <label for="profileEmail">Email</label>
                            <input type="email" id="profileEmail" required>
                        </div>
                        <div class="form-group">
                            <label>Role</label>
                            <input type="text" id="profileRoleInput" disabled style="background: #e9ecef;">
                        </div>
                        <button type="submit" class="btn btn-primary">Update Profile</button>
                        <p class="success-message" id="profileSuccess" style="display: none;"></p>
                    </form>
                    <div class="password-section">
                        <h3>Change Password</h3>
                        <form id="passwordForm">
                            <div class="form-group">
                                <label for="currentPassword">Current Password</label>
                                <input type="password" id="currentPassword" required>
                            </div>
                            <div class="form-group">
                                <label for="newPassword">New Password</label>
                                <input type="password" id="newPassword" required minlength="6">
                            </div>
                            <div class="form-group">
                                <label for="confirmPassword">Confirm New Password</label>
                                <input type="password" id="confirmPassword" required minlength="6">
                            </div>
                            <button type="submit" class="btn btn-primary">Change Password</button>
                            <p class="error-message" id="passwordError" style="display: none;"></p>
                            <p class="success-message" id="passwordSuccess" style="display: none;"></p>
                        </form>
                    </div>
                    <button onclick="hideProfile()" class="btn btn-secondary">Back to Dashboard</button>
                </div>
            </div>

            <!-- Settings Section -->
            <div class="section" id="settingsSection" style="display: none;">
                <div class="modern-card settings-card">
                    <h2>Settings</h2>
                    <div class="settings-content">
                        <div class="setting-item">
                            <h3>Notifications</h3>
                            <label class="switch">
                                <input type="checkbox" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="setting-item">
                            <h3>Email Notifications</h3>
                            <label class="switch">
                                <input type="checkbox" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="setting-item">
                            <h3>Language</h3>
                            <select class="setting-select">
                                <option>English</option>
                                <option>Spanish</option>
                                <option>French</option>
                            </select>
                        </div>
                    </div>
                    <button onclick="hideSettings()" class="btn btn-secondary">Back</button>
                </div>
            </div>

            <!-- Messages Section -->
            <div class="section" id="messagesSection" style="display: none;">
                <div class="messages-container">
                    <!-- Top Header -->
                    <div class="messages-header">
                        <div class="messages-header-left">
                            <h2>Message üòä</h2>
                        </div>
                        <div class="messages-header-center">
                            <div class="messages-search-bar">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                                </svg>
                                <input type="text" placeholder="Search" id="messagesGlobalSearch">
                            </div>
                        </div>
                        <div class="messages-header-right">
                            <button class="messages-icon-btn" title="Notifications">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z"/>
                                </svg>
                                <span class="notification-badge">2</span>
                            </button>
                            <div class="messages-user-profile">
                                <div class="messages-avatar-small">
                                    <span id="messagesUserInitials"></span>
                                </div>
                                <div class="messages-user-info">
                                    <span id="messagesUserName"></span>
                                    <span class="messages-user-role">User</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Messages Content -->
                    <div class="messages-content">
                        <!-- Left Sidebar - Contacts -->
                        <div class="messages-sidebar">
                            <div class="messages-sidebar-search">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                                </svg>
                                <input type="text" placeholder="Search..." id="messagesContactSearch">
                            </div>
                            <div class="messages-contacts-list" id="messagesContactsList">
                                <!-- Contacts will be loaded here -->
                            </div>
                            <button class="messages-view-more-btn">View More</button>
                        </div>

                        <!-- Main Chat Area -->
                        <div class="messages-chat-area">
                            <div class="messages-chat-header" id="messagesChatHeader" style="display: none;">
                                <div class="messages-chat-contact">
                                    <div class="messages-avatar-small" id="messagesChatAvatar">
                                        <span></span>
                                    </div>
                                    <span id="messagesChatName"></span>
                                </div>
                                <div class="messages-chat-actions">
                                    <button class="messages-icon-btn" title="Search">
                                        <svg width="18" height="18" viewBox="0 0 16 16" fill="currentColor">
                                            <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                                        </svg>
                                    </button>
                                    <button class="messages-icon-btn" title="Settings">
                                        <svg width="18" height="18" viewBox="0 0 16 16" fill="currentColor">
                                            <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"/>
                                            <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-1.893-4.74-.902-4.306 1.135l.073.276c.08.284.255.568.518.79l.265.196c-.004.1-.015.2-.015.305 0 .164.01.325.03.483l-.26.19a.873.873 0 0 1-1.263.516l-.292-.16c-1.64 1.893-1.035 4.688 1.135 4.306l.276-.073a.873.873 0 0 1 .79.518l.196.265c.1.004.2.015.305.015.164 0 .325-.01.483-.03l.19.26a.873.873 0 0 1 .516 1.263l-.16.292c-1.893 1.64-.902 4.74 1.135 4.306l.276.073a.873.873 0 0 1 .518.79l.196.265c.004.1.015.2.015.305 0 .164-.01.325-.03.483l.26.19a.873.873 0 0 1 .516 1.263l-.16.292c-1.893 1.64-4.688 1.035-4.306-1.135l.073-.276a.873.873 0 0 1-.518-.79l-.196-.265a7.454 7.454 0 0 1-.015-.305c0-.164.01-.325.03-.483l-.26-.19a.873.873 0 0 1-.516-1.263l.16-.292c1.893-1.64.902-4.74-1.135-4.306l-.276.073a.873.873 0 0 1-.79-.518l-.196-.265a7.454 7.454 0 0 1-.015-.305c0-.164.01-.325.03-.483l.26-.19a.873.873 0 0 1 1.263-.516l.292.16c1.64-1.893 4.74-.902 4.306 1.135l-.073.276a.873.873 0 0 1-.518.79l-.196.265c-.004.1-.015.2-.015.305 0 .164.01.325.03.483l.26.19a.873.873 0 0 1-1.263.516l-.292-.16c-1.64-1.893-1.035-4.688 1.135-4.306l.276.073a.873.873 0 0 1 .79-.518l.196-.265c.1-.004.2-.015.305-.015.164 0 .325.01.483.03l.19-.26a.873.873 0 0 1 1.263-.516l.292.16c1.893-1.64 4.688-1.035 4.306 1.135l-.073.276a.873.873 0 0 1 .518.79l.196.265c.004.1.015.2.015.305 0 .164-.01.325-.03.483l-.26-.19a.873.873 0 0 1-.516-1.263l.16-.292z"/>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="messages-chat-messages" id="messagesChatMessages">
                                <div class="messages-empty-state">
                                    <p>Select a contact to start messaging</p>
                                </div>
                            </div>
                            <div class="messages-chat-input" id="messagesChatInput" style="display: none;">
                                <button class="messages-input-btn" title="Attach">
                                    <svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor">
                                        <path d="M11.5 2a.5.5 0 0 1 .5.5v11a.5.5 0 0 1-1 0v-11a.5.5 0 0 1 .5-.5zm-11 6a.5.5 0 0 1 .5.5v3a.5.5 0 0 0 .5.5h6a.5.5 0 0 1 0 1h-6A1.5 1.5 0 0 1 0 12V9a.5.5 0 0 1 .5-.5z"/>
                                    </svg>
                                </button>
                                <input type="text" placeholder="Message..." id="messagesInputField">
                                <button class="messages-input-btn" title="Emoji">
                                    <svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor">
                                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                                        <path d="M4.285 9.567a.5.5 0 0 1 .683.183A3.498 3.498 0 0 0 8 11.5a3.498 3.498 0 0 0 3.032-1.75.5.5 0 1 1 .866.5A4.498 4.498 0 0 1 8 12.5a4.498 4.498 0 0 1-3.898-2.25.5.5 0 0 1 .183-.683zM7 6.5C7 7.328 6.552 8 6 8s-1-.672-1-1.5S5.448 5 6 5s1 .672 1 1.5zm4 0c0 .828-.448 1.5-1 1.5s-1-.672-1-1.5S9.448 5 10 5s1 .672 1 1.5z"/>
                                    </svg>
                                </button>
                                <button class="messages-send-btn" title="Send" onclick="sendMessage()">
                                    <svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor">
                                        <path d="M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761-4.53L1.698 6.84l4.938.23Zm1.141 3.439l-1.591-4.993L12.316 2.5l-4.539 10.009Z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="app.js"></script>
</body>
</html>

